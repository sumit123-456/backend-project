{% extends 'app/base.html' %}
{% block content %}

<!-- CONTENT --><main class="content-wrap"><div class="d-flex justify-content-between mb-3" style="background:#fff;border:1px solid #e5e7eb;padding:10px 15px;border-radius:4px;"><div class="page-title">Leave Management System Test</div><a href="/dashboard/"><div class="text-muted">Dashboard</div></a></div><!-- TEST STATISTICS --><div style="display:flex; gap:20px; flex-wrap:wrap; margin:20px 0; font-family:Poppins, sans-serif;"><!-- CARD 1 --><div style="flex:1; min-width:220px; background:#ffffff; border-radius:10px;
                border-top:6px solid #0a6d65; padding:25px; text-align:center;
                box-shadow:0px 2px 6px rgba(0,0,0,0.08);"><div style="font-size:38px; color:#1a73e8; margin-bottom:8px;"><i class="fa-solid fa-users"></i></div><div style="font-size:32px; font-weight:700; color:#000;">{{ test_stats.employees }}</div><div style="font-size:15px; color:#666; margin-top:4px;">Total Employees</div></div><!-- CARD 2 --><div style="flex:1; min-width:220px; background:#ffffff; border-radius:10px;
                border-top:6px solid #0a6d65; padding:25px; text-align:center;
                box-shadow:0px 2px 6px rgba(0,0,0,0.08);"><div style="font-size:38px; color:#f2b33d; margin-bottom:8px;"><i class="fa-solid fa-user-tie"></i></div><div style="font-size:32px; font-weight:700; color:#000;">{{ test_stats.team_leaders }}</div><div style="font-size:15px; color:#666; margin-top:4px;">Team Leaders</div></div><!-- CARD 3 --><div style="flex:1; min-width:220px; background:#ffffff; border-radius:10px;
                border-top:6px solid #0a6d65; padding:25px; text-align:center;
                box-shadow:0px 2px 6px rgba(0,0,0,0.08);"><div style="font-size:38px; color:#e63946; margin-bottom:8px;"><i class="fa-solid fa-calendar"></i></div><div style="font-size:32px; font-weight:700; color:#000;">{{ test_stats.leave_applications }}</div><div style="font-size:15px; color:#666; margin-top:4px;">Leave Applications</div></div><!-- CARD 4 --><div style="flex:1; min-width:220px; background:#ffffff; border-radius:10px;
                border-top:6px solid #0a6d65; padding:25px; text-align:center;
                box-shadow:0px 2px 6px rgba(0,0,0,0.08);"><div style="font-size:38px; color:#06b6d4; margin-bottom:8px;"><i class="fa-solid fa-clock"></i></div><div style="font-size:32px; font-weight:700; color:#000;">{{ test_stats.pending_leaves }}</div><div style="font-size:15px; color:#666; margin-top:4px;">Pending Approvals</div></div></div><!-- TEST CONTROLS --><div style="background:#ffffff; border-radius:10px; box-shadow:0px 2px 6px rgba(0,0,0,0.08); 
            border:1px solid #e5e7eb; overflow:hidden; margin:20px 0;"><div style="padding:20px; border-bottom:1px solid #e5e7eb;background-color: #0a6d65;"><h5 style="margin:0; font-weight:600; color:#f5f3f3;"><i class="fas fa-vial me-2"></i><span>Test Leave Management System</span></h5></div><div style="padding:30px;"><div class="row"><div class="col-md-8"><h6>System Overview</h6><p>This is a comprehensive Leave Application, Approval & Management System with the following features:</p><ul><li><strong>Multi-Day Leave Policy:</strong> Employees can apply for up to 30 days leave per application (10 days per month limit)</li><li><strong>Monthly Tracking:</strong> System tracks how many leaves an employee takes in a month</li><li><strong>Two-Step Approval:</strong> TL reviews first → Forwards to HR → HR final approval</li><li><strong>Email Notifications:</strong> Automatic emails sent to employees on approval/rejection</li><li><strong>Database Storage:</strong> All data stored in database with proper relationships</li><li><strong>Dashboard Integration:</strong> Leave data displayed on all user dashboards</li></ul><h6>Test Credentials</h6><div style="background:#f8f9fa; padding:15px; border-radius:6px; border-left:4px solid #0a6d65;"><p><strong>Employee Login:</strong> employee@test.com / password123</p><p><strong>Team Leader Login:</strong> tl@test.com / password123</p><p><strong>HR Login:</strong> Create an HR account from HR Management → Create HR</p></div></div><div class="col-md-4"><h6>Create Test Data</h6><form method="POST">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-primary" style="width:100%; margin-bottom:10px;"><i class="fas fa-plus me-2"></i>Create Sample Data
                    </button></form><p><small>This will create sample employees, team leader, and leave applications for testing.</small></p><h6>Quick Links</h6><div style="display:flex; flex-direction:column; gap:10px;"><a href="/apply-leave/" class="btn btn-outline-primary btn-sm"><i class="fas fa-calendar-plus me-2"></i>Employee Leave Apply
                    </a><a href="/team-leave-approval/" class="btn btn-outline-warning btn-sm"><i class="fas fa-check-circle me-2"></i>TL Leave Approval
                    </a><a href="/leave-approvals/" class="btn btn-outline-success btn-sm"><i class="fas fa-user-shield me-2"></i>HR Leave Approval
                    </a></div></div></div></div></div><!-- RECENT LEAVE APPLICATIONS -->
  {% if recent_leaves %}
  <div style="background:#ffffff; border-radius:10px; box-shadow:0px 2px 6px rgba(0,0,0,0.08); 
            border:1px solid #e5e7eb; overflow:hidden; margin:20px 0;"><div style="padding:20px; border-bottom:1px solid #e5e7eb;background-color: #0a6d65;"><h5 style="margin:0; font-weight:600; color:#f5f3f3;"><i class="fas fa-history me-2"></i><span>Recent Leave Applications</span></h5></div><div class="table-responsive"><table class="table table-hover mb-0" style="font-family:Poppins, sans-serif;"><thead style="background:#f8f9fa;"><tr><th class="px-4 py-3" style="font-weight:600; color:#333; font-size:14px;">Employee</th><th class="px-4 py-3" style="font-weight:600; color:#333; font-size:14px;">Leave Type</th><th class="px-4 py-3" style="font-weight:600; color:#333; font-size:14px;">Date</th><th class="px-4 py-3" style="font-weight:600; color:#333; font-size:14px;">Days</th><th class="px-4 py-3" style="font-weight:600; color:#333; font-size:14px;">Reason</th><th class="px-4 py-3" style="font-weight:600; color:#333; font-size:14px;">Status</th></tr></thead><tbody>
                {% for leave in recent_leaves %}
                <tr><td class="px-4 py-3">{{ leave.employee.first_name }} {{ leave.employee.last_name }}</td><td class="px-4 py-3">{{ leave.get_leave_type_display }}</td><td class="px-4 py-3">{{ leave.start_date|date:"M d, Y" }}</td><td class="px-4 py-3">{{ leave.total_days }}</td><td class="px-4 py-3">{{ leave.reason|truncatechars:30 }}</td><td class="px-4 py-3">
                        {% if leave.status == 'approved' %}
                            <span class="badge bg-success">Approved</span>
                        {% elif leave.status == 'pending' %}
                            <span class="badge bg-warning text-dark">Pending</span>
                        {% elif leave.status == 'rejected' %}
                            <span class="badge bg-danger">Rejected</span>
                        {% else %}
                            <span class="badge bg-secondary">{{ leave.status|title }}</span>
                        {% endif %}
                    </td></tr>
                {% endfor %}
            </tbody></table></div></div>
  {% endif %}

  <!-- WORKFLOW EXPLANATION --><div style="background:#ffffff; border-radius:10px; box-shadow:0px 2px 6px rgba(0,0,0,0.08); 
            border:1px solid #e5e7eb; overflow:hidden; margin:20px 0;"><div style="padding:20px; border-bottom:1px solid #e5e7eb;background-color: #0a6d65;"><h5 style="margin:0; font-weight:600; color:#f5f3f3;"><i class="fas fa-project-diagram me-2"></i><span>Leave Approval Workflow</span></h5></div><div style="padding:30px;"><div class="row"><div class="col-md-3 text-center"><div style="background:#e3f2fd; padding:20px; border-radius:10px; margin-bottom:10px;"><i class="fas fa-user fa-2x text-primary mb-3"></i><h6>1. Employee Applies</h6><p><small>Employee submits leave request form with reason and dates</small></p></div></div><div class="col-md-3 text-center"><div style="background:#fff3e0; padding:20px; border-radius:10px; margin-bottom:10px;"><i class="fas fa-user-tie fa-2x text-warning mb-3"></i><h6>2. Team Leader Review</h6><p><small>TL reviews and either approves/rejects or forwards to HR</small></p></div></div><div class="col-md-3 text-center"><div style="background:#e8f5e8; padding:20px; border-radius:10px; margin-bottom:10px;"><i class="fas fa-user-shield fa-2x text-success mb-3"></i><h6>3. HR Final Approval</h6><p><small>HR gives final approval and sends notification email</small></p></div></div><div class="col-md-3 text-center"><div style="background:#f3e5f5; padding:20px; border-radius:10px; margin-bottom:10px;"><i class="fas fa-envelope fa-2x text-info mb-3"></i><h6>4. Employee Notified</h6><p><small>Employee receives email notification of approval/rejection</small></p></div></div></div></div></div></main>

{% endblock %}