{% extends 'app/base.html' %}
{% block content %}

<!-- CONTENT --><main class="content-wrap"><div class="d-flex justify-content-between mb-3" style="background:#fff;border:1px solid #e5e7eb;padding:10px 15px;border-radius:4px;"><div class="page-title">My Profile</div><a href="{% url 'hr-dashboard' %}"><div class="text-muted">Dashboard</div></a></div><!-- PROFILE OVERVIEW --><div style="background:#ffffff; border-radius:10px; box-shadow:0px 2px 6px rgba(0,0,0,0.08); 
            border:1px solid #e5e7eb; overflow:hidden; margin:20px 0;"><!-- Profile Header --><div style="padding:30px; border-bottom:1px solid #e5e7eb;background: linear-gradient(135deg, #0b7368 0%, #0a6d65 100%); color:white;"><div style="display:flex; align-items:center; gap:25px; flex-wrap: wrap;"><!-- Profile Picture --><div style="position:relative;"><div style="width:120px; height:120px; border-radius:50%; background:#f8f9fa; 
                           display:flex; align-items:center; justify-content:center; 
                           border:4px solid white; box-shadow:0 4px 12px rgba(0,0,0,0.2); overflow: hidden;">
                    {% if hr.profile_image %}
                        <img src="{{ hr.profile_image.url }}" alt="Profile" style="width: 100%; height: 100%; object-fit: cover;">
                    {% else %}
                        <i class="fas fa-user" style="font-size:48px; color:#0b7368;"></i>
                    {% endif %}
                </div><button onclick="changeProfilePicture()" 
                        style="position:absolute; bottom:0; right:0; width:35px; height:35px; 
                               background:#28a745; border:2px solid white; border-radius:50%; 
                               color:white; cursor:pointer; display:flex; align-items:center; justify-content:center;"><i class="fas fa-camera" style="font-size:12px;"></i></button></div><!-- Profile Info --><div style="flex:1; min-width: 250px;"><h3 style="margin:0; font-weight:700; font-size:28px;" id="hrName">{{ hr.full_name }}</h3><p style="margin:5px 0; font-size:16px; opacity:0.9;" id="hrDesignation">{{ hr.designation }}</p><p style="margin:5px 0; font-size:14px; opacity:0.8;" id="hrDepartment">{{ hr.department }}</p><div style="display:flex; gap:15px; margin-top:15px; flex-wrap: wrap;"><div style="background:rgba(255,255,255,0.2); padding:8px 12px; border-radius:20px; font-size:12px;"><i class="fas fa-calendar me-1"></i><span>Joined:</span> {{ hr.date_of_joining|date:"F Y" }}
                    </div><div style="background:rgba(255,255,255,0.2); padding:8px 12px; border-radius:20px; font-size:12px;"><i class="fas fa-id-card me-1"></i><span>ID:</span> {{ hr.employee_id }}
                    </div><div style="background:rgba(255,255,255,0.2); padding:8px 12px; border-radius:20px; font-size:12px;"><i class="fas fa-envelope me-1"></i><span>Email:</span> {{ hr.email }}
                    </div><div style="background:rgba(255,255,255,0.2); padding:8px 12px; border-radius:20px; font-size:12px;"><i class="fas fa-shield-alt me-1"></i><span>Access:</span> {{ hr.access_level }}
                    </div></div></div><!-- Edit Profile Button --><div><button onclick="editProfile()" 
                        style="background:white; color:#0b7368; border:none;
                               padding:12px 20px; border-radius:8px; font-weight:600; 
                               font-size:14px; box-shadow:0 2px 8px rgba(0,0,0,0.2);"><i class="fas fa-edit me-2"></i><span>Edit Profile</span></button></div></div></div><!-- Profile Tabs --><div style="padding:0;"><ul class="nav nav-tabs" style="border-bottom:1px solid #e5e7eb; background:#f8f9fa;"><li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#personalInfo" 
                   style="border:none; color:#333; font-weight:600; padding:15px 20px;"><i class="fas fa-user me-2"></i><span>Personal Information</span></a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#workInfo" 
                   style="border:none; color:#333; font-weight:600; padding:15px 20px;"><i class="fas fa-briefcase me-2"></i><span>Work Information</span></a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#hrStats" 
                   style="border:none; color:#333; font-weight:600; padding:15px 20px;"><i class="fas fa-chart-bar me-2"></i><span>HR Statistics</span></a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#settings" 
                   style="border:none; color:#333; font-weight:600; padding:15px 20px;"><i class="fas fa-cog me-2"></i><span>Settings</span></a></li></ul><!-- Tab Content --><div class="tab-content" style="padding:30px;"><!-- Personal Information Tab --><div class="tab-pane fade show active" id="personalInfo"><div class="row g-4"><div class="col-md-6"><label class="form-label fw-bold">Full Name</label><input type="text" class="form-control" value="{{ hr.full_name }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div><div class="col-md-6"><label class="form-label fw-bold">Employee ID</label><input type="text" class="form-control" value="{{ hr.employee_id }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div><div class="col-md-6"><label class="form-label fw-bold">Email Address</label><input type="email" class="form-control" value="{{ hr.email }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div><div class="col-md-6"><label class="form-label fw-bold">Mobile Number</label><input type="tel" class="form-control" value="{{ hr.mobile }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div><div class="col-md-6"><label class="form-label fw-bold">Username</label><input type="text" class="form-control" value="{{ hr.username }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div><div class="col-md-6"><label class="form-label fw-bold">Access Level</label><input type="text" class="form-control" value="{{ hr.access_level }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div><div class="col-md-6"><label class="form-label fw-bold">Date of Joining</label><input type="date" class="form-control" value="{{ hr.date_of_joining|date:'Y-m-d' }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div><div class="col-md-6"><label class="form-label fw-bold">Work Location</label><input type="text" class="form-control" value="{{ hr.work_location }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div><div class="col-md-6"><label class="form-label fw-bold">Account Created</label><input type="text" class="form-control" value="{{ hr.created_at|date:'F d, Y H:i' }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div></div></div><!-- Work Information Tab --><div class="tab-pane fade" id="workInfo"><div class="row g-4"><div class="col-md-6"><label class="form-label fw-bold">Designation</label><input type="text" class="form-control" value="{{ hr.designation }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div><div class="col-md-6"><label class="form-label fw-bold">Department</label><input type="text" class="form-control" value="{{ hr.department }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div><div class="col-md-6"><label class="form-label fw-bold">Work Location</label><input type="text" class="form-control" value="{{ hr.work_location }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div><div class="col-md-6"><label class="form-label fw-bold">Access Level</label><input type="text" class="form-control" value="{{ hr.access_level }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div><div class="col-md-6"><label class="form-label fw-bold">Date of Joining</label><input type="date" class="form-control" value="{{ hr.date_of_joining|date:'Y-m-d' }}" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div><div class="col-md-6"><label class="form-label fw-bold">Years of Experience</label><input type="text" class="form-control" value="{{ experience_years }} Years" readonly 
                               style="background:#f8f9fa; border:1px solid #ddd; border-radius:8px; padding:12px;" /></div></div></div><!-- HR Statistics Tab --><div class="tab-pane fade" id="hrStats"><div class="row g-4"><div class="col-md-6"><div style="border:1px solid #e5e7eb; border-radius:8px; padding:20px; text-align:center; background:#f8f9fa;"><h3 style="color:#0b7368; margin:0; font-size:36px; font-weight:700;">{{ total_employees }}</h3><p style="margin:5px 0; color:#666; font-weight:600;">Total Employees</p><small style="color:#999;">Under HR Management</small></div></div><div class="col-md-6"><div style="border:1px solid #e5e7eb; border-radius:8px; padding:20px; text-align:center; background:#f8f9fa;"><h3 style="color:#0b7368; margin:0; font-size:36px; font-weight:700;">{{ total_announcements }}</h3><p style="margin:5px 0; color:#666; font-weight:600;">Announcements Posted</p><small style="color:#999;">Company Communications</small></div></div><div class="col-12"><h6 class="fw-bold mb-3" style="color:#333;">Recent Activities</h6><div class="row g-3"><div class="col-md-6"><div style="border:1px solid #e5e7eb; border-radius:8px; padding:15px; background:#f8f9fa;"><i class="fas fa-users" style="color:#0b7368; font-size:24px; margin-bottom:10px;"></i><div style="font-weight:600; margin-bottom:5px;">Employee Management</div><small style="color:#666;">Manage employee records and profiles</small></div></div><div class="col-md-6"><div style="border:1px solid #e5e7eb; border-radius:8px; padding:15px; background:#f8f9fa;"><i class="fas fa-bullhorn" style="color:#0b7368; font-size:24px; margin-bottom:10px;"></i><div style="font-weight:600; margin-bottom:5px;">Announcement Management</div><small style="color:#666;">Post company-wide announcements</small></div></div><div class="col-md-6"><div style="border:1px solid #e5e7eb; border-radius:8px; padding:15px; background:#f8f9fa;"><i class="fas fa-calendar-check" style="color:#0b7368; font-size:24px; margin-bottom:10px;"></i><div style="font-weight:600; margin-bottom:5px;">Leave Management</div><small style="color:#666;">Approve and manage leave requests</small></div></div><div class="col-md-6"><div style="border:1px solid #e5e7eb; border-radius:8px; padding:15px; background:#f8f9fa;"><i class="fas fa-chart-line" style="color:#0b7368; font-size:24px; margin-bottom:10px;"></i><div style="font-weight:600; margin-bottom:5px;">Reports & Analytics</div><small style="color:#666;">Generate HR reports and insights</small></div></div></div></div></div></div><!-- Settings Tab --><div class="tab-pane fade" id="settings"><div class="row g-4"><div class="col-12"><h6 class="fw-bold mb-3">Account Settings</h6><!-- Change Password --><div style="border:1px solid #e5e7eb; border-radius:8px; padding:20px; margin-bottom:20px;"><h6 class="fw-bold mb-3" style="color:#333;">Change Password</h6><div class="row g-3"><div class="col-md-4"><label class="form-label">Current Password</label><input type="password" class="form-control" placeholder="••••••••" /></div><div class="col-md-4"><label class="form-label">New Password</label><input type="password" class="form-control" placeholder="••••••••" /></div><div class="col-md-4"><label class="form-label">Confirm Password</label><input type="password" class="form-control" placeholder="••••••••" /></div></div><div class="mt-3"><button class="btn btn-outline-primary"><i class="fas fa-key me-2"></i><span>Update Password</span></button></div></div><!-- Notification Settings --><div style="border:1px solid #e5e7eb; border-radius:8px; padding:20px; margin-bottom:20px;"><h6 class="fw-bold mb-3" style="color:#333;">Notification Settings</h6><div class="row g-3"><div class="col-md-6"><div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="emailNotifications" checked><label class="form-check-label" for="emailNotifications">Email Notifications</label></div><small class="text-muted">Receive notifications via email</small></div><div class="col-md-6"><div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="smsNotifications"><label class="form-check-label" for="smsNotifications">SMS Notifications</label></div><small class="text-muted">Receive notifications via SMS</small></div><div class="col-md-6"><div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="leaveNotifications" checked><label class="form-check-label" for="leaveNotifications">Leave Notifications</label></div><small class="text-muted">Get notifications for leave requests</small></div><div class="col-md-6"><div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="announcementNotifications" checked><label class="form-check-label" for="announcementNotifications">Announcement Notifications</label></div><small class="text-muted">Receive HR announcement notifications</small></div></div></div><!-- Privacy Settings --><div style="border:1px solid #e5e7eb; border-radius:8px; padding:20px; margin-bottom:20px;"><h6 class="fw-bold mb-3" style="color:#333;">Privacy Settings</h6><div class="row g-3"><div class="col-md-6"><div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="profileVisibility" checked><label class="form-check-label" for="profileVisibility">Profile Visibility</label></div><small class="text-muted">Allow employees to view your HR profile</small></div><div class="col-md-6"><div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="activityStatus"><label class="form-check-label" for="activityStatus">Show Activity Status</label></div><small class="text-muted">Show when you're online</small></div></div></div><!-- Save Settings Button --><div class="text-end"><button class="btn btn-success"><i class="fas fa-save me-2"></i><span>Save Settings</span></button></div></div></div></div></div></div></div></main><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script><script>

// Change profile picture
function changeProfilePicture() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'image/*';
    input.onchange = function(event) {
        const file = event.target.files[0];
        if (file) {
            // In real implementation, this would upload the file and update the profile picture
            alert('Profile picture updated successfully!');
        }
    };
    input.click();
}

// Edit profile
function editProfile() {
    // Remove readonly attribute from all inputs to enable editing
    const readonlyInputs = document.querySelectorAll('input[readonly], textarea[readonly], select[readonly]');
    readonlyInputs.forEach(input => {
        input.removeAttribute('readonly');
        input.style.backgroundColor = '#fff';
    });

    // Change edit button to save button
    const editButton = document.querySelector('button[onclick="editProfile()"]');
    editButton.innerHTML = '<i class="fas fa-save me-2"></i><span>Save Profile</span>';
    editButton.onclick = saveProfile;
}

// Save profile
function saveProfile() {
    if (confirm('Are you sure you want to save the changes?')) {
        // Add readonly attribute back to all inputs
        const editableInputs = document.querySelectorAll('input:not([readonly]), textarea:not([readonly]), select:not([readonly])');
        editableInputs.forEach(input => {
            input.setAttribute('readonly', 'readonly');
            input.style.backgroundColor = '#f8f9fa';
        });

        // Change save button back to edit button
        const saveButton = document.querySelector('button[onclick="saveProfile()"]');
        saveButton.innerHTML = '<i class="fas fa-edit me-2"></i><span>Edit Profile</span>';
        saveButton.onclick = editProfile;

        alert('Profile updated successfully!');
    }
}

// Initialize tooltips and other Bootstrap components
document.addEventListener('DOMContentLoaded', function() {
    // Initialize Bootstrap components if needed
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });
});
</script>

{% endblock %}